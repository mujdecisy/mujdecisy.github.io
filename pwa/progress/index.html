<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="style.css">
    <title>Progress</title>
    <link rel="manifest" href="/pwa/_conf/manifest-progress.json" />
    <!-- ios support -->
    <link rel="apple-touch-icon" href="/pwa/_conf/icon-192x192.png" />
    <link rel="apple-touch-icon" href="/pwa/_conf/icon-256x256.png" />
    <link rel="apple-touch-icon" href="/pwa/_conf/icon-384x384.png" />
    <link rel="apple-touch-icon" href="/pwa/_conf/icon-512x512.png" />
    <meta name="apple-mobile-web-app-status-bar" content="#f6c935" />
    <meta name="theme-color" content="#f6c935" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
        integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <main class="pwa-main">
        <div id="navigation"></div>
        <div id="content"></div>
    </main>

    <script src="script.js"></script>

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/pwa/progress/sw.js').then(_ => {
                console.log('serviceworker registration SUCCESS!');
            }).catch(err => {
                console.error('serviceworker registration FAILED!', err);
            });
        }

        var TARGET_DATE = new Date(sessionStorage.getItem(KS_TARGETDATE));
        var TARGET_TIME = sessionStorage.getItem(KS_TARGETTIME);
        var TARGET_TASKID = parseInt(sessionStorage.getItem(KS_TARGETTASKID), '0');

        window.onload = _ => {
            const searchParams = new URLSearchParams(window.location.search);
            const page = searchParams.get('page');
            const content = document.getElementById('content');
            renderNavigationBarById();
            if (page === 'task-add') {
                renderPageTaskAdd(content);
            } else if (page === 'task-list') {
                renderPageTaskList(content);
            } else if (page === 'task-detail') {
                renderPageTaskDetail(content, TARGET_TASKID);
            } else if (page === 'assignment') {
                renderPageAssignment(content, TARGET_DATE, TARGET_TIME);
            } else {
                renderPageDashBoard(content, TARGET_DATE);
            }
        };
    </script>

</body>

</html>